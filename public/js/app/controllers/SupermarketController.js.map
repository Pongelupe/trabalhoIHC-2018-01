{"version":3,"sources":["../../app-es6/controllers/SupermarketController.js"],"names":["SupermarketController","_init","$","document","querySelector","bind","_inputName","_inputValue","_inputCategory","_listProducts","Bind","ProductsList","ProductsView","_message","Message","MessageView","swal","closeOnEsc","closeOnClickOutside","text","content","element","attributes","value","type","step","then","_initialValue","innerHTML","debitsView","_debits","Debits","DebitsView","idProduct","product","remove","name","removeDebit","parseFloat","event","preventDefault","Product","_addProduct","errors","_isProductValid","length","add","addDebit","_resetForm","_suggestProduct","map","error","join","productSugested","sugestNew","icon","buttons","validationsErrors","push","removeAll","focus"],"mappings":"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","file":"SupermarketController.js","sourcesContent":["class SupermarketController {\n\n    constructor() {\n        this._init();\n\n        let $ = document.querySelector.bind(document);\n\n        this._inputName = $('#productName');\n        this._inputValue = $('#productValue');\n        this._inputCategory = $('#productCategory');\n        this._listProducts = new Bind(new ProductsList(),\n            new ProductsView($('#productsView')), 'add', 'remove', 'removeAll');\n        this._message = new Bind(\n            new Message(), new MessageView($('#mesageView')),\n            'content');\n    }\n\n    _init() {\n        swal({\n            closeOnEsc: false,\n            closeOnClickOutside: false,\n            text: \"Insira o valor que será gasto nesta compra!\",\n            content: {\n                element: \"input\",\n                attributes: {\n                    value: \"0.00\",\n                    type: \"Number\",\n                    step: \"0.01\",\n                },\n            }\n        }).then(value => {\n            if (!value)\n                this._init();\n            else {\n                this._initialValue = value;\n                document.querySelector('#initialValue').innerHTML = value;\n                let debitsView = document.querySelector('#debits');\n                this._debits = new Bind(new Debits(value),\n                    new DebitsView(debitsView), 'addDebit', 'removeDebit', 'removeAll');\n            }\n        });\n    }\n\n    deleteProduct(idProduct) {\n        let product = this._listProducts.remove(idProduct);\n\n        this._message.type = 'success';\n        this._message.content = `${product.name} removido com sucesso!`;\n\n        this._debits.removeDebit(parseFloat(product.value));\n    }\n\n    addProduct(event) {\n        event.preventDefault();\n        let product = new Product(this._inputValue.value, this._inputName.value, this._inputCategory.value);\n        this._addProduct(product);\n\n    }\n\n\t\tinfo() {\n\t\t\tswal(\"Ooopsy Daisy!\",\"Não encontrou o que procurava? Nossa equipe está elaborando novos produtos =)\",\"info\");\n\t\t}\n\n    _addProduct(product) {\n        let errors = this._isProductValid(product);\n        if (errors.length == 0) {\n\n            this._listProducts.add(product);\n\n            this._message.type = 'success';\n            this._message.content = `${product.name} adicionado com sucesso!`;\n\n            this._debits.addDebit(product.value);\n\n            this._resetForm();\n            this._suggestProduct();\n        } else {\n\n            this._message.type = 'danger';\n            this._message.content = `Erro ao adicionar:<br/>\n                    ${errors.map(error => error).join('<br/>')}`;\n        }\n    }\n\n    _suggestProduct() {\n        if (this._listProducts.length % 3 == 0) {\n            let productSugested = this._listProducts.sugestNew();\n            swal({\n                closeOnClickOutside: false,\n                icon: 'warning',\n                text: `Deseja adicionar ${productSugested.name} a sua lista?\\n\n                Por apenas R$ ${productSugested.value}`,\n                buttons: [\"Não por agora\", true]\n            })\n                .then(value => {\n                    if (value)\n                        this._addProduct(productSugested);\n                });\n        }\n    }\n\n    _isProductValid(product) {\n        let validationsErrors = [];\n        if (product.name == '')\n            validationsErrors.push('O nome não pode ser vazio!');\n        if (product.value <= 1.0)\n            validationsErrors.push('O valor deve ser superior a 1,00 real!');\n\n        return validationsErrors;\n    }\n\n    removeAllProducts() {\n        swal({\n            icon: 'warning',\n            text: \"Deseja limpar sua lista?\",\n            buttons: [\"Cancelar\", true]\n        })\n            .then(value => {\n                if (value) {\n                    this._listProducts.removeAll();\n                    this._debits.removeAll();\n                }\n            });\n    }\n\n    _resetForm() {\n\n        this._inputName.value = '';\n        this._inputValue.value = 0.0;\n        this._inputCategory.value = 'Alimentação';\n\n        this._inputName.focus();\n    }\n\n}\n"]}